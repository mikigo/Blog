import{_ as i,c as a,R as n,o as e}from"./chunks/framework.CpY5Ih_Y.js";const E=JSON.parse('{"title":"Selenium—8小时入门版","description":"","frontmatter":{"Author":"mikigo"},"headers":[],"relativePath":"自动化技术/UI自动化/Selenium—8小时入门版.md","filePath":"自动化技术/UI自动化/Selenium—8小时入门版.md","lastUpdated":1737267928000}'),t={name:"自动化技术/UI自动化/Selenium—8小时入门版.md"};function l(h,s,p,k,d,r){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="selenium—8小时入门版" tabindex="-1">Selenium—8小时入门版 <a class="header-anchor" href="#selenium—8小时入门版" aria-label="Permalink to &quot;Selenium—8小时入门版&quot;">​</a></h1><h2 id="一、一句话简介" tabindex="-1">一、一句话简介 <a class="header-anchor" href="#一、一句话简介" aria-label="Permalink to &quot;一、一句话简介&quot;">​</a></h2><p>selenium 是一个 web 应用程序的测试工具。</p><h2 id="二、安装" tabindex="-1">二、安装 <a class="header-anchor" href="#二、安装" aria-label="Permalink to &quot;二、安装&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> selenium</span></span></code></pre></div><p>浏览器驱动，注意一定要和你的浏览器版本匹配；</p><p>selenium 驱动：<a href="https://npm.taobao.org/mirrors/chromedriver/" target="_blank" rel="noreferrer">https://npm.taobao.org/mirrors/chromedriver/</a></p><h2 id="三、常用控制方法" tabindex="-1">三、常用控制方法 <a class="header-anchor" href="#三、常用控制方法" aria-label="Permalink to &quot;三、常用控制方法&quot;">​</a></h2><h3 id="启动浏览器" tabindex="-1">启动浏览器 <a class="header-anchor" href="#启动浏览器" aria-label="Permalink to &quot;启动浏览器&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver.Chrome()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http:www.baidu.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="浏览器控制" tabindex="-1">浏览器控制 <a class="header-anchor" href="#浏览器控制" aria-label="Permalink to &quot;浏览器控制&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置窗口为像素500,500大小</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.set_window_size(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 最大化浏览器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.maximize_window()  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 后退</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.back()     </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 前进</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.forward()  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 刷新</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.refresh()  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 关闭当前窗口，但不会切换窗口</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.close()    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 退出所有窗口 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.quit()</span></span></code></pre></div><h3 id="_8种元素定位方法" tabindex="-1">8种元素定位方法 <a class="header-anchor" href="#_8种元素定位方法" aria-label="Permalink to &quot;8种元素定位方法&quot;">​</a></h3><h4 id="_1-id" tabindex="-1">1.id <a class="header-anchor" href="#_1-id" aria-label="Permalink to &quot;1.id&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_id()</span></span></code></pre></div><h4 id="_2-name" tabindex="-1">2.name <a class="header-anchor" href="#_2-name" aria-label="Permalink to &quot;2.name&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_name()</span></span></code></pre></div><h4 id="_3-class-name" tabindex="-1">3.class_name <a class="header-anchor" href="#_3-class-name" aria-label="Permalink to &quot;3.class_name&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_class_name()</span></span></code></pre></div><h4 id="_4-tag-name" tabindex="-1">4.tag_name <a class="header-anchor" href="#_4-tag-name" aria-label="Permalink to &quot;4.tag_name&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_tag_name()</span></span></code></pre></div><h4 id="_5-link-text" tabindex="-1">5.link_text <a class="header-anchor" href="#_5-link-text" aria-label="Permalink to &quot;5.link_text&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_link_text()</span></span></code></pre></div><h4 id="_6-partial-link-text" tabindex="-1">6.partial_link_text <a class="header-anchor" href="#_6-partial-link-text" aria-label="Permalink to &quot;6.partial_link_text&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_partial_link_text()</span></span></code></pre></div><h4 id="_7-css-selector" tabindex="-1">7.css_selector <a class="header-anchor" href="#_7-css-selector" aria-label="Permalink to &quot;7.css_selector&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_css_selector()</span></span></code></pre></div><ul><li><code>.class</code> ，比如：<code>.bg</code> 选择类为 <code>bg</code> 的所有元素；</li><li><code>#id</code> ，比如：<code>#kw </code> 选择 <code>id</code> 为 <code>kw</code> 的元素；</li><li><code>element&gt;element</code>，比如：<code>span&gt;input</code> 选择 <code>span</code> 下的所有 <code>input</code> 子元素（不含孙）；</li><li><code>element element</code>，比如：<code>span input</code> 选择 <code>span</code> 下的所有 <code>input</code> 子元素（含孙）；</li><li><code>element+element</code>，比如：<code>span+input</code> 选择与 <code>span</code> 同级的，且紧接着的 <code>input</code> 元素（只有一个）；</li><li><code>[attribute^=value]</code>，比如：<code>a[class^=&quot;bg&quot;]</code> 选择类是以 <code>bg</code> 开头的 <code>a</code> 元素（<code>$</code> 是以什么结尾）；</li><li><code>:nth-child</code>，比如：<code>input:nth-child(2)</code> 选择父元素下第 2 个位置为 <code>input</code> 的元素（先找位置，再找元素）；</li><li><code>:nth-of-type</code>，比如：<code>input:nth-of-type(2)</code> 选择父元素下元素 <code>input</code> 的第 2 个（先找元素，再找位置）；</li></ul><h4 id="_8-xpth" tabindex="-1">8.xpth <a class="header-anchor" href="#_8-xpth" aria-label="Permalink to &quot;8.xpth&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">find_element_by_xpath()</span></span></code></pre></div><p><strong>（1）绝对定位</strong></p><p>从 /html 开始，一层一层的往下找。</p><p><strong>（2）相对定位，以 // 开头</strong></p><ul><li><p>元素属性定位</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_xpath（</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;//input[@id=&#39;kw&#39;]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">），属性值必须加引号。</span></span></code></pre></div></li><li><p>层级属性结合</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_xpath（</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;//form[@id=&#39;form&#39;]/span/input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）</span></span></code></pre></div></li><li><p>使用逻辑运算符</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_xpath（</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;//input[@name=&#39;wd&#39; and @class=&#39;s_ipt&#39;]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）</span></span></code></pre></div></li><li><p>使用 <code>contains</code></p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_xpath（</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;//input[contains(@class,&#39;bg&#39;)]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查找内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_xpath（</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;//a[contains(text(),&#39;新闻&#39;)]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">） </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查找内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_xpath（</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;//a[text()=&#39;新闻&#39;]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）</span></span></code></pre></div></li></ul><h3 id="其他常用" tabindex="-1">其他常用 <a class="header-anchor" href="#其他常用" aria-label="Permalink to &quot;其他常用&quot;">​</a></h3><h4 id="定位一组元素" tabindex="-1">定位一组元素 <a class="header-anchor" href="#定位一组元素" aria-label="Permalink to &quot;定位一组元素&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_elements_by_css_selector(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#form&gt;span&gt;input)</span></span></code></pre></div><p>返回的是一个列表；</p><h4 id="使用by类" tabindex="-1">使用By类 <a class="header-anchor" href="#使用by类" aria-label="Permalink to &quot;使用By类&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium.webdriver.common.by </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> By</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver.Chrome()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http:www.baidu.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;kw&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将小写改成大写，比如 name 改成 By.NEME</span></span></code></pre></div><h2 id="四、简单元素操作" tabindex="-1">四、简单元素操作 <a class="header-anchor" href="#四、简单元素操作" aria-label="Permalink to &quot;四、简单元素操作&quot;">​</a></h2><h3 id="_1-清除文本" tabindex="-1">1.清除文本 <a class="header-anchor" href="#_1-清除文本" aria-label="Permalink to &quot;1.清除文本&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element（By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;kw&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）.clear()</span></span></code></pre></div><h3 id="_2-模拟按键输入" tabindex="-1">2.模拟按键输入 <a class="header-anchor" href="#_2-模拟按键输入" aria-label="Permalink to &quot;2.模拟按键输入&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element（By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;kw&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）.send_keys(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;苹果&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_3-单击元素" tabindex="-1">3.单击元素 <a class="header-anchor" href="#_3-单击元素" aria-label="Permalink to &quot;3.单击元素&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element（By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;su&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）.click()</span></span></code></pre></div><h3 id="_4-提交表单" tabindex="-1">4.提交表单 <a class="header-anchor" href="#_4-提交表单" aria-label="Permalink to &quot;4.提交表单&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element（By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;su&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）.submit()</span></span></code></pre></div><h3 id="_5-获取元素信息" tabindex="-1">5.获取元素信息 <a class="header-anchor" href="#_5-获取元素信息" aria-label="Permalink to &quot;5.获取元素信息&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取当前url</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.current_url</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取元素的文本内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_link_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;新闻&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).text  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 获取输入框元素的class属性的属性值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_id(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kw&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).get_attribute(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;class&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_6-元素再操作" tabindex="-1">6.元素再操作 <a class="header-anchor" href="#_6-元素再操作" aria-label="Permalink to &quot;6.元素再操作&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element（By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ul&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">）.find_element(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PARTIAL_LINK_TEXT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;新闻&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span></code></pre></div><h2 id="五、鼠标事件" tabindex="-1">五、鼠标事件 <a class="header-anchor" href="#五、鼠标事件" aria-label="Permalink to &quot;五、鼠标事件&quot;">​</a></h2><h3 id="_1-实例" tabindex="-1">1.实例 <a class="header-anchor" href="#_1-实例" aria-label="Permalink to &quot;1.实例&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium.wedriver.common.action_chains </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ActionChains</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver.Chrome()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http:www.jd.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">locator </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LINK_TEXT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;家用电器&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">locat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> driver.find_element(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">locator) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实例化</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">action </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ActionChains(driver)    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 一定要提交</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">action </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> move_to_element(locat).perform()</span></span></code></pre></div><h3 id="_2-常用的鼠标事件" tabindex="-1">2.常用的鼠标事件 <a class="header-anchor" href="#_2-常用的鼠标事件" aria-label="Permalink to &quot;2.常用的鼠标事件&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 鼠标右键点击</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context_click(locat)  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 左键双击</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">double_click(locat) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 鼠标拖动，从source_locat拖动到target_locat</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">drag_and_drop(source_locat,target_locat)  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 鼠标悬停</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">move_to_element(locat) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 在元素上按下左键不放</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">click_and_hold(local)</span></span></code></pre></div><h2 id="六、键盘事件" tabindex="-1">六、键盘事件 <a class="header-anchor" href="#六、键盘事件" aria-label="Permalink to &quot;六、键盘事件&quot;">​</a></h2><h3 id="_1-实例-1" tabindex="-1">1.实例 <a class="header-anchor" href="#_1-实例-1" aria-label="Permalink to &quot;1.实例&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 引入Keys类</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium.wedriver.common.keys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Keys </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver.Chrome()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http:www.jd.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_id(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).send_keys(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;蒙牛&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element_by_id(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).send_keys(Keys.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ENTER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_2-常用的键盘事件" tabindex="-1">2.常用的键盘事件 <a class="header-anchor" href="#_2-常用的键盘事件" aria-label="Permalink to &quot;2.常用的键盘事件&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 删除 （与键盘对应）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">send_keys(Keys.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BACK_SPACE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="七、select类" tabindex="-1">七、Select类 <a class="header-anchor" href="#七、select类" aria-label="Permalink to &quot;七、Select类&quot;">​</a></h2><h3 id="_1-实例-2" tabindex="-1">1.实例 <a class="header-anchor" href="#_1-实例-2" aria-label="Permalink to &quot;1.实例&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium.wedriver.support.select </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Select</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 找到select元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">locat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> driver.find_element(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;brand_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实例化</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">select </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Select(locat) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 选择太平鸟</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">select.select_by_visible_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;太平鸟&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="八、内联框架" tabindex="-1">八、内联框架 <a class="header-anchor" href="#八、内联框架" aria-label="Permalink to &quot;八、内联框架&quot;">​</a></h2><p>1.一个网页里面可能会遇到多个frame，不同的frame之间需要切换才能进行操作</p><p>2.逐级进入</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入main_frame这一层</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.frame(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main_frame&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 再进入header_frame这一层</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.frame(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;header_frame&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>3.跳转到兄弟级</p><p>先调到上一级，在进入兄弟级</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 跳到上一级</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.parent_frame(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>4.跳出所有的frame</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.default_content()</span></span></code></pre></div><h2 id="九、窗口切换" tabindex="-1">九、窗口切换 <a class="header-anchor" href="#九、窗口切换" aria-label="Permalink to &quot;九、窗口切换&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 返回所有窗口的句柄</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.window_handles 		</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 切换窗口</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.window(handles[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取当前窗口的句柄</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.current_window_handle</span></span></code></pre></div><h2 id="十、其他常见控件" tabindex="-1">十、其他常见控件 <a class="header-anchor" href="#十、其他常见控件" aria-label="Permalink to &quot;十、其他常见控件&quot;">​</a></h2><h3 id="_1-日期控件" tabindex="-1">1.日期控件 <a class="header-anchor" href="#_1-日期控件" aria-label="Permalink to &quot;1.日期控件&quot;">​</a></h3><p>能够写的直接写日期，不能写的，去掉readonly属性；</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">js </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;document.getElementById(&#39;start_date&#39;).removeAttribute(&#39;readonly&#39;)&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.execute_script(js)</span></span></code></pre></div><h3 id="_2-单选或复选框" tabindex="-1">2.单选或复选框 <a class="header-anchor" href="#_2-单选或复选框" aria-label="Permalink to &quot;2.单选或复选框&quot;">​</a></h3><p>找到用click即可；</p><h3 id="_3-表格" tabindex="-1">3.表格 <a class="header-anchor" href="#_3-表格" aria-label="Permalink to &quot;3.表格&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取tr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tr_list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ele_tboy.find_elements(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TAG_NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">，</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tr&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tr_list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:]:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # td元素对象列表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	tmp_td_list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tr.find_elements(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TAGE_NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;td&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#td就是元素对象</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> td </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tmp_td_list:  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 打印表格中的所有内容</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(td.text)   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取第二行第三列的值</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># tbody元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ele_tbody </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> driver.find_element(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">XPATH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;//*[@id=&quot;myTable&quot;]/tbody&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取tr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tr_list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ele_tbody.find_elements(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TAG_NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tr&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取td</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">td_list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tr_list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].find_elements(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TAG_NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;td&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(td_list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].text)</span></span></code></pre></div><h2 id="十一、警告框处理" tabindex="-1">十一、警告框处理 <a class="header-anchor" href="#十一、警告框处理" aria-label="Permalink to &quot;十一、警告框处理&quot;">​</a></h2><p>在处理警告弹窗之前，仍然需要先点击触发的按钮</p><h3 id="_1-切换到alert页面" tabindex="-1">1.切换到alert页面 <a class="header-anchor" href="#_1-切换到alert页面" aria-label="Permalink to &quot;1.切换到alert页面&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;alert&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取文本</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.alert.text  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 点击确定</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.alert.accept()   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输入内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.alert.send_keys(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;警告&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 点击取消</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.switch_to.alert.dissmiss()</span></span></code></pre></div><h3 id="_2-引入alert类" tabindex="-1">2.引入Alert类 <a class="header-anchor" href="#_2-引入alert类" aria-label="Permalink to &quot;2.引入Alert类&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium.webdriver.common.alert </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Alert</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">alert </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Alert(driver)</span></span></code></pre></div><h2 id="十二、截图" tabindex="-1">十二、截图 <a class="header-anchor" href="#十二、截图" aria-label="Permalink to &quot;十二、截图&quot;">​</a></h2><ul><li><p><code>driver.save_screenshot(&quot;screnshot.png&quot;)</code> 返回一个图片文件；</p></li><li><p>浏览器换成 <code>PhantomJS</code>，可截整个网页；</p></li><li><p>截下一页，可以先将光标移动到下一页，然后截图即可；</p></li></ul><h2 id="十三、设置等待" tabindex="-1">十三、设置等待 <a class="header-anchor" href="#十三、设置等待" aria-label="Permalink to &quot;十三、设置等待&quot;">​</a></h2><h3 id="_1-强制等待" tabindex="-1">1.强制等待 <a class="header-anchor" href="#_1-强制等待" aria-label="Permalink to &quot;1.强制等待&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sleep</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sleep(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_2-隐式等待" tabindex="-1">2.隐式等待 <a class="header-anchor" href="#_2-隐式等待" aria-label="Permalink to &quot;2.隐式等待&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webdriver.Chrome()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.implicitly_wait(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>一般在打开浏览器后进行声明，表示：30秒内一旦加载完毕，就执行下一条语句，如果没有，就抛异常。</p><h3 id="_3-显式等待" tabindex="-1">3.显式等待 <a class="header-anchor" href="#_3-显式等待" aria-label="Permalink to &quot;3.显式等待&quot;">​</a></h3><p>针对某一个步骤，隐式等待时间不够长，可以专门设置一个显式等待。</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium.webdriver.support.ui </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WebDriverWait</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> selenium.webdriver.support </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expected_conditions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EC</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置等待</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每个0.5秒检查一下，总时间为10秒之内。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wait </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WebDriverWait(driver, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 定位元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wait.until(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.presence_of_element_located((By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kw&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)))</span></span></code></pre></div><h2 id="十四、上传文件" tabindex="-1">十四、上传文件 <a class="header-anchor" href="#十四、上传文件" aria-label="Permalink to &quot;十四、上传文件&quot;">​</a></h2><p>1.input标签</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 用send_keys直接给文件路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.find_element(By.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;kw&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).send_keys(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;D</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1.jpg&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>2.非 <code>input</code> 标签（弹窗形式）</p><p>用三方工具 <code>Auto Windows Info</code></p><h2 id="十五、验证码" tabindex="-1">十五、验证码 <a class="header-anchor" href="#十五、验证码" aria-label="Permalink to &quot;十五、验证码&quot;">​</a></h2><p>1.去掉验证码</p><p>2.设置万能验证码</p><p>3.验证码识别技术</p><p>4.操作 <code>cookie</code></p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">driver.add_cookie(cookie_dict)</span></span></code></pre></div>`,113)]))}const c=i(t,[["render",l]]);export{E as __pageData,c as default};
