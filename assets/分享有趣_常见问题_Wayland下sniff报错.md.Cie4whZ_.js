import{_ as i,c as a,R as n,o as t}from"./chunks/framework.CuFLN7ac.js";const h="/Blog/faq/sniff_error.png",p="/Blog/faq/sniff_error2.png",c=JSON.parse('{"title":"Wayland下sniff命令报错~/.Xauthorty文件不存在","description":"","frontmatter":{"Author":"mikigo"},"headers":[],"relativePath":"分享有趣/常见问题/Wayland下sniff报错.md","filePath":"分享有趣/常见问题/Wayland下sniff报错.md","lastUpdated":1736790406000}'),l={name:"分享有趣/常见问题/Wayland下sniff报错.md"};function e(k,s,r,d,E,o){return t(),a("div",null,s[0]||(s[0]=[n('<h1 id="wayland下sniff命令报错-xauthorty文件不存在" tabindex="-1">Wayland下sniff命令报错~/.Xauthorty文件不存在 <a class="header-anchor" href="#wayland下sniff命令报错-xauthorty文件不存在" aria-label="Permalink to &quot;Wayland下sniff命令报错~/.Xauthorty文件不存在&quot;">​</a></h1><p><img src="'+h+`" alt=""></p><p>根据 Xlib.xauth 源代码里面这里：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Xauthority</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, filename </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filename </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            filename </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.environ.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;XAUTHORITY&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filename </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                filename </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.path.join(os.environ[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;HOME&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.Xauthority&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            except</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> KeyError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                raise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error.XauthError(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;$HOME not set, cannot find ~/.Xauthority&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            raw </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(filename, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;rb&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).read()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        except</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> OSError</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            raise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error.XauthError(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;~/.Xauthority: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.entries </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span></code></pre></div><p>是因为读文件 <code>filename</code> 的时候报错，<code>filename</code> 要么从环境变量 <code>XAUTHORITY</code> 里面拿，要么就赋值 <code>~/.Xauthority</code>，而咱们系统中 <code>~/.Xauthority</code> 文件是存在的，那么肯定就是环境变量里面 <code>XAUTHORITY</code> 的值有问题； 查看一下：</p><p><img src="`+p+`" alt=""></p><p>环境变量里面有 <code>XAUTHORITY</code>，但是值为空；</p><p>所以这就是问题，<code>filename</code> 拿到一个空串，<code>open</code> 读肯定会报 <code>OSError</code>；</p><p>解决方法，在 <code>sniff</code> 的代码里面把 <code>XAUTHORITY=~/.Xauthority</code> 这个环境变量加上理论上就行了；</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>import os</span></span>
<span class="line"><span>os.environ[&quot;XAUTHORITY&quot;] = &quot;$HOME/.Xauthority&quot;</span></span></code></pre></div><p>再执行 <code>sniff</code> 就不会报错啦；</p>`,11)]))}const g=i(l,[["render",e]]);export{c as __pageData,g as default};
