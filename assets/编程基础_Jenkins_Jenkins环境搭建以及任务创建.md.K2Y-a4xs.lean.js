import{_ as i,c as a,R as n,o as l}from"./chunks/framework.CpY5Ih_Y.js";const t="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA.png",p="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E9%80%9A%E7%94%A8%E6%A8%A1%E5%9D%97.png",e="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E6%9D%83%E9%99%90.png",k="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E9%87%8D%E6%9E%84.png",h="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E4%BB%BB%E5%8A%A1%E5%8F%82%E6%95%B0.png",E="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E7%A6%81%E6%AD%A2%E9%87%8D%E6%9E%84.png",B="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E9%99%90%E5%88%B6%E5%B9%B6%E5%8F%91%E6%95%B0%E9%87%8F.png",r="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E5%85%81%E8%AE%B8%E5%B9%B6%E5%8F%91.png",o="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E9%99%90%E5%88%B6%E8%8A%82%E7%82%B9.png",F="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/git.png",A="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/git%E5%88%86%E6%94%AF.png",d="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E6%9E%84%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8.png",g="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E6%9E%84%E5%BB%BA%E6%93%8D%E4%BD%9C.png",c="/blog/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E6%9E%84%E5%BB%BA%E5%90%8E%E6%93%8D%E4%BD%9C.png",v=JSON.parse('{"title":"Jenkins环境搭建以及任务创建","description":"","frontmatter":{"Author":"zhx"},"headers":[],"relativePath":"编程基础/Jenkins/Jenkins环境搭建以及任务创建.md","filePath":"编程基础/Jenkins/Jenkins环境搭建以及任务创建.md","lastUpdated":1737219290000}'),y={name:"编程基础/Jenkins/Jenkins环境搭建以及任务创建.md"};function u(m,s,C,_,b,J){return l(),a("div",null,s[0]||(s[0]=[n(`<h1 id="jenkins环境搭建以及任务创建" tabindex="-1">Jenkins环境搭建以及任务创建 <a class="header-anchor" href="#jenkins环境搭建以及任务创建" aria-label="Permalink to &quot;Jenkins环境搭建以及任务创建&quot;">​</a></h1><h2 id="环境搭建" tabindex="-1">环境搭建 <a class="header-anchor" href="#环境搭建" aria-label="Permalink to &quot;环境搭建&quot;">​</a></h2><p>下面主要讲解一下利用Jenkins容器搭建Jenkins环境</p><p>1、下载kenkins容器镜像(建议下载lts稳定版本)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jenkins/Jenkins:lts</span></span></code></pre></div><p>2、创建docker的文件影射卷</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inspect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jenkins_zuo</span></span></code></pre></div><p>3、运行容器</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jenkins_rongqi</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:8080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:50000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Jenkins_zuo:/var/Jenkins_home</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jenkins/Jenkins:lts</span></span></code></pre></div><p>8080端口是Jenkins对外服务开放的端口</p><p>50000端口是slave节点与Jenkins的通讯端口</p><p>4、查看容器启动日志，查看Jenkins的初始密码</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jenkins_rongqi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/Jenkins_home/secrets/initialAdminPassword</span></span></code></pre></div><p>5、通过web端8080端口，访问Jenkins登录页面，使用初始密码可以成功登录</p><p>6、进入插件选择页面，选择自己想要使用的插件</p><p>7、创建用户，创建Jenkins URL等基础配置，Jenkins安装完成</p><h2 id="任务创建" tabindex="-1">任务创建 <a class="header-anchor" href="#任务创建" aria-label="Permalink to &quot;任务创建&quot;">​</a></h2><p>1、入口</p><p>(1) 点击&quot;新建Item&quot;按钮，进入任务创建页面</p><p><img src="`+t+'" alt="任务创建"></p><p>(2)可以选择创建一个新的任务，输入任务名称，选择任务类型，点击确定即可，也可以选择复制一个现有的任务，输入任务名称，填入想要复制的任务路径，点击确定</p><p>2、任务设置</p><p>这里以&#39;Freestyle project&#39;类型任务进行举例</p><p>(1)通用模块设置</p><ul><li>填写项目的描述信息</li></ul><img src="'+p+'" alt="项目描述" style="zoom:120%;"><ul><li>设置用户权限</li></ul><img src="'+e+'" alt="权限" style="zoom:120%;"><ul><li>项目重构：重新构建这个作业而不需要再次输入参数，也就是说，它会使用上一次构建时使用的参数值直接进行构建</li></ul><img src="'+k+'" alt="重构" style="zoom:120%;"><ul><li>任务构建参数选择：</li></ul><p>添加一些参数变量信息到你的Jenkins工程当中，根据参数类型，每个参数都有一个Name和某种类型的Value。当构建开始时，这些名称-值对将作为环境变量导出，允许构建配置的后续部分(例如构建步骤)访问这些值，例如通过使用${PARAMETER_NAME}语法使用这些变量</p><img src="'+h+'" alt="任务参数" style="zoom:120%;"><ul><li>禁止重构，勾选后，任务将不支持重构功能</li></ul><img src="'+E+'" alt="禁止重构" style="zoom:120%;"><ul><li>限制job的最大并发数量</li></ul><img src="'+B+'" alt="限制并发数量" style="zoom:120%;"><ul><li>允许项目并发执行</li></ul><img src="'+r+'" alt="允许并发" style="zoom:120%;"><ul><li>限制job的运行环境，填写slave节点的标签即可</li></ul><img src="'+o+'" alt="限制节点" style="zoom:120%;"><p>(2)源码管理模块</p><ul><li><p>设置要在任务中要使用的代码仓</p><p>Repository URL：代码仓库地址</p><p>Credentials:ssh私钥，用于免密clone仓库</p><img src="'+F+'" alt="git" style="zoom:120%;"></li><li><p>仓库分支设置</p><p>指定分支：clone仓库的哪个分支</p></li></ul><img src="'+A+`" alt="git分支" style="zoom:120%;"><ul><li><p>添加仓库附加行为</p><p>根据你使用的版本控制系统，选择一个或多个附加行为。以下是一些常见的 Git 附加行为：</p><ul><li><p>Check out to a sub-directory: 将检出代码放到一个子目录中</p></li><li><p>Clean before checkout: 在每次检出之前清理工作区，确保不会有遗留的文件</p></li><li><p>Prune stale remote-tracking branches: 清理不再存在的远程分支的跟踪记录</p></li><li><p>Advanced clone behaviours: 配置高级克隆选项，如 --depth、--single-branch 等</p></li></ul></li></ul><p>(3)构建触发器模块</p><ul><li><p>任务构建设置</p><ul><li><p>触发远程构建：当想要利用脚本远程触发Jenkins任务的时候，可以选择此选项</p><ul><li>假如此处勾选了此选项，设置一个token值，用于远程控制任务，我们可以通过python的第三方库python-Jenkins进行任务的构建，日志查看等操作，下面是一个简单的demo</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jenkins</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;http://Jenkinswh.uniontech.com/Jenkinsb/job/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5%BC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%80%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">E5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%8F%91%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">E5%B7%A5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%85%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">B7&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ut005046&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">password </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;jiubugaosuni&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jk </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jenkins.Jenkins(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">url, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">username</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">username, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">password</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">password, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">timeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jk.build_job(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;test_zz&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">parameters</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;kernel&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;4.19&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;zuohanxu&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></li><li><p>Build periodically：定时触发Jenkins任务，如下，每周的星期五中午 12 点执行任务：H 12 * * 5</p></li><li><p>Poll SCM：用于设置 Jenkins 任务如何定期检查源码管理系统（SCM）以检测代码更改。如果检测到更改，Jenkins 将自动触发构建，如设置为H/15 * * * *，则会15分钟检查一次代码变更情况</p></li><li><p>Build after other projects are built：用于配置当前项目在其他项目完成构建后进行构建</p></li></ul></li></ul><img src="`+d+'" alt="构建触发器" style="zoom:120%;"><p>(4)构建模块</p><ul><li>点击“增加构建步骤”，可以选择构建的方式，最常见的是Excute shell,可以通过shell命令，进行相关build操作</li></ul><img src="'+g+'" alt="构建操作" style="zoom:120%;"><p>(5)构建后操作模块</p><ul><li>build完成后，进行的一系列操作，比如说，可以将测试结果通过企业微信发送至项目负责人</li></ul><img src="'+c+'" alt="构建后操作" style="zoom:120%;">',54)]))}const z=i(y,[["render",u]]);export{v as __pageData,z as default};
